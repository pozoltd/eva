<?php

/**
 * 2017-05-16 21:45:33
 */

namespace Eva\ORMs;

class Asset extends \Eva\Db\ORM
{

    function getFieldMap()
    {
        global $TBL_META;
        return array_merge(array(
            'title' => 'title',
            'description' => 'description',
            'isFolder' => 'extra1',
            'fileName' => 'extra2',
            'fileType' => 'extra4',
            'fileSize' => 'extra5',
            'fileLocation' => 'extra6',
        ), array_combine(array_keys($TBL_META), array_keys($TBL_META)), array(
            'id' => 'id',
            'track' => 'track',
        ));
    }

    function getTable()
    {
        return '__contents';
    }

    function delete()
    {
        if (!$this->isFolder && file_exists(dirname($_SERVER['SCRIPT_FILENAME']) . '/../uploads/' . $this->fileLocation)) {
            unlink(dirname($_SERVER['SCRIPT_FILENAME']) . '/../uploads/' . $this->fileLocation);
        }
        parent::delete(); // TODO: Change the autogenerated stub
    }

    function getChildren() {
        return Asset::getORMsByField($this->zdb, '__parentId', $this->id);
    }
}